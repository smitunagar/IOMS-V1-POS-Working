module.exports = {

"[project]/.next-internal/server/app/api/menuCsv/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/@opentelemetry/api [external] (@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("@opentelemetry/api", () => require("@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/perf_hooks [external] (perf_hooks, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("perf_hooks", () => require("perf_hooks"));

module.exports = mod;
}}),
"[externals]/node:perf_hooks [external] (node:perf_hooks, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:perf_hooks", () => require("node:perf_hooks"));

module.exports = mod;
}}),
"[externals]/async_hooks [external] (async_hooks, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("async_hooks", () => require("async_hooks"));

module.exports = mod;
}}),
"[externals]/events [external] (events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/process [external] (process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}}),
"[externals]/child_process [external] (child_process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/require-in-the-middle [external] (require-in-the-middle, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("require-in-the-middle", () => require("require-in-the-middle"));

module.exports = mod;
}}),
"[externals]/import-in-the-middle [external] (import-in-the-middle, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("import-in-the-middle", () => require("import-in-the-middle"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/tls [external] (tls, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}}),
"[externals]/net [external] (net, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}}),
"[externals]/http2 [external] (http2, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http2", () => require("http2"));

module.exports = mod;
}}),
"[externals]/dns [external] (dns, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("dns", () => require("dns"));

module.exports = mod;
}}),
"[externals]/dgram [external] (dgram, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("dgram", () => require("dgram"));

module.exports = mod;
}}),
"[externals]/assert [external] (assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}}),
"[externals]/buffer [external] (buffer, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}}),
"[externals]/tty [external] (tty, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/querystring [external] (querystring, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}}),
"[externals]/node:events [external] (node:events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}}),
"[externals]/node:process [external] (node:process, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:process", () => require("node:process"));

module.exports = mod;
}}),
"[externals]/node:util [external] (node:util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}}),
"[externals]/node:async_hooks [external] (node:async_hooks, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:async_hooks", () => require("node:async_hooks"));

module.exports = mod;
}}),
"[externals]/node:crypto [external] (node:crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:crypto", () => require("node:crypto"));

module.exports = mod;
}}),
"[externals]/diagnostics_channel [external] (diagnostics_channel, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("diagnostics_channel", () => require("diagnostics_channel"));

module.exports = mod;
}}),
"[externals]/express [external] (express, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("express", () => require("express"));

module.exports = mod;
}}),
"[externals]/fs/promises [external] (fs/promises, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs/promises", () => require("fs/promises"));

module.exports = mod;
}}),
"[project]/src/ai/genkit.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "ai": (()=>ai)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/genkit/lib/index.mjs [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$genkit$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/genkit/lib/genkit.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$genkit$2d$ai$2f$googleai$2f$lib$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/@genkit-ai/googleai/lib/index.mjs [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$genkit$2d$ai$2f$googleai$2f$lib$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@genkit-ai/googleai/lib/index.mjs [app-route] (ecmascript) <locals>");
;
;
const ai = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$genkit$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["genkit"])({
    plugins: [
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$genkit$2d$ai$2f$googleai$2f$lib$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["googleAI"])()
    ],
    model: 'googleai/gemini-2.0-flash'
});
}}),
"[project]/src/lib/inventoryService.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
// Inventory Service
// Provides functions to manage inventory in localStorage
__turbopack_context__.s({
    "addIngredientToInventoryIfNotExists": (()=>addIngredientToInventoryIfNotExists),
    "addInventoryItem": (()=>addInventoryItem),
    "addOrUpdateIngredientInInventory": (()=>addOrUpdateIngredientInInventory),
    "getInventory": (()=>getInventory),
    "getInventoryAlerts": (()=>getInventoryAlerts),
    "getInventoryAlertsDetailed": (()=>getInventoryAlertsDetailed),
    "recordIngredientUsage": (()=>recordIngredientUsage),
    "removeInventoryItem": (()=>removeInventoryItem),
    "saveInventory": (()=>saveInventory),
    "updateInventoryAlerts": (()=>updateInventoryAlerts),
    "updateInventoryItem": (()=>updateInventoryItem)
});
const INVENTORY_KEY_PREFIX = 'inventory_';
function getInventory(userId) {
    if ("TURBOPACK compile-time truthy", 1) return [];
    "TURBOPACK unreachable";
    const data = undefined;
}
function addInventoryItem(userId, item) {
    if ("TURBOPACK compile-time truthy", 1) return null;
    "TURBOPACK unreachable";
    const inventory = undefined;
    const newItem = undefined;
}
function updateInventoryItem(userId, item) {
    if ("TURBOPACK compile-time truthy", 1) return false;
    "TURBOPACK unreachable";
    const inventory = undefined;
    const idx = undefined;
}
function removeInventoryItem(userId, itemId) {
    if ("TURBOPACK compile-time truthy", 1) return false;
    "TURBOPACK unreachable";
    const inventory = undefined;
    const newInventory = undefined;
}
function addOrUpdateIngredientInInventory(userId, ingredient) {
    const inventory = getInventory(userId);
    const idx = inventory.findIndex((i)=>i.name.toLowerCase() === ingredient.name.toLowerCase());
    if (idx !== -1) {
        inventory[idx] = {
            ...inventory[idx],
            ...ingredient,
            quantityUsed: inventory[idx].quantityUsed || 0,
            totalUsed: inventory[idx].totalUsed || 0
        };
    } else {
        inventory.push({
            ...ingredient,
            id: ingredient.id || Date.now().toString(),
            quantityUsed: ingredient.quantityUsed || 0,
            totalUsed: ingredient.totalUsed || 0
        });
    }
    localStorage.setItem(INVENTORY_KEY_PREFIX + userId, JSON.stringify(inventory));
    return ingredient;
}
function addIngredientToInventoryIfNotExists(userId, ingredient) {
    const inventory = getInventory(userId);
    const exists = inventory.some((i)=>i.name.toLowerCase() === ingredient.name.toLowerCase());
    if (!exists) {
        addInventoryItem(userId, ingredient);
        return true;
    }
    return false;
}
function getInventoryAlerts(userId) {
    const inventory = getInventory(userId);
    return inventory.filter((i)=>i.lowStockThreshold && i.quantity <= i.lowStockThreshold).map((i)=>`Low stock: ${i.name} (${i.quantity} ${i.unit})`);
}
function updateInventoryAlerts(userId) {
    if ("TURBOPACK compile-time truthy", 1) return;
    "TURBOPACK unreachable";
}
function saveInventory(userId, inventory) {
    localStorage.setItem(INVENTORY_KEY_PREFIX + userId, JSON.stringify(inventory));
}
function getInventoryAlertsDetailed(userId) {
    const inventory = getInventory(userId);
    return inventory.filter((i)=>i.lowStockThreshold !== undefined && i.quantity <= (i.lowStockThreshold ?? 0)).map((i)=>({
            itemId: i.id,
            itemName: i.name,
            quantity: i.quantity,
            unit: i.unit,
            message: `Low stock: ${i.name} (${i.quantity} ${i.unit})`
        }));
}
function recordIngredientUsage(userId, dish, quantity) {
// No-op placeholder
}
}}),
"[project]/src/lib/menuService.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
// Menu Service
// Provides functions to manage menu items in localStorage
__turbopack_context__.s({
    "addDish": (()=>addDish),
    "addDishToMenu": (()=>addDishToMenu),
    "getDishes": (()=>getDishes),
    "removeDish": (()=>removeDish),
    "saveDishes": (()=>saveDishes),
    "updateDish": (()=>updateDish)
});
const MENU_KEY_PREFIX = 'menu_';
function getDishes(userId) {
    if ("TURBOPACK compile-time truthy", 1) return [];
    "TURBOPACK unreachable";
    const data = undefined;
}
function saveDishes(userId, dishes) {
    localStorage.setItem(MENU_KEY_PREFIX + userId, JSON.stringify(dishes));
}
function addDish(userId, dish) {
    if ("TURBOPACK compile-time truthy", 1) return null;
    "TURBOPACK unreachable";
    const dishes = undefined;
    const newDish = undefined;
}
function updateDish(userId, dish) {
    if ("TURBOPACK compile-time truthy", 1) return false;
    "TURBOPACK unreachable";
    const dishes = undefined;
    const idx = undefined;
}
function removeDish(userId, dishId) {
    if ("TURBOPACK compile-time truthy", 1) return false;
    "TURBOPACK unreachable";
    const dishes = undefined;
    const newDishes = undefined;
}
const addDishToMenu = addDish;
}}),
"[project]/src/ai/flows/ingredient-types.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "GenerateIngredientsListInputSchema": (()=>GenerateIngredientsListInputSchema),
    "GenerateIngredientsListOutputSchema": (()=>GenerateIngredientsListOutputSchema),
    "IngredientSchema": (()=>IngredientSchema),
    "SuggestExpiryDateInputSchema": (()=>SuggestExpiryDateInputSchema),
    "SuggestExpiryDateOutputSchema": (()=>SuggestExpiryDateOutputSchema)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/genkit/lib/index.mjs [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/genkit/lib/common.js [app-route] (ecmascript)");
;
const GenerateIngredientsListInputSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].object({
    dishName: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('The name of the dish to generate ingredients for.'),
    numberOfServings: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].number().describe('The number of servings the ingredients should be for.')
});
const IngredientSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].object({
    name: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('The name of the ingredient.'),
    quantity: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].number().describe('The quantity of the ingredient (numeric value).'),
    unit: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('The unit for the quantity (e.g., "g", "ml", "pcs", "kg").')
});
const GenerateIngredientsListOutputSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].object({
    ingredients: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].array(IngredientSchema).describe('A list of ingredients with their names, quantities, and units.')
});
const SuggestExpiryDateInputSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].object({
    productName: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('The name of the product.'),
    productCategory: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().optional().describe('The category of the product (e.g., "Tea", "Spices", "Sweets").'),
    productWeight: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().optional().describe('The weight/unit of the product (e.g., "500g", "1000g", "20 pkt").'),
    manufacturingDate: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().optional().describe('The manufacturing date if available.')
});
const SuggestExpiryDateOutputSchema = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].object({
    suggestedExpiryDate: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('The suggested expiry date in YYYY-MM-DD format.'),
    shelfLifeDays: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].number().describe('The estimated shelf life in days.'),
    storageRecommendation: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('Storage recommendation for the product.'),
    confidence: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$genkit$2f$lib$2f$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["z"].string().describe('Confidence level of the suggestion (High, Medium, Low).')
});
}}),
"[project]/src/ai/flows/generate-ingredients-list.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
/* __next_internal_action_entry_do_not_use__ [{"4079b6b9abb8c7b682ab09d09cf1810f6f192164f9":"generateIngredientsList"},"",""] */ __turbopack_context__.s({
    "generateIngredientsList": (()=>generateIngredientsList)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$app$2d$render$2f$encryption$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/app-render/encryption.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$genkit$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/ai/genkit.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$ingredient$2d$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/ai/flows/ingredient-types.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js [app-route] (ecmascript)");
;
;
;
;
const prompt = __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$genkit$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ai"].definePrompt({
    name: 'generateIngredientsListPrompt',
    input: {
        schema: __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$ingredient$2d$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GenerateIngredientsListInputSchema"]
    },
    output: {
        schema: __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$ingredient$2d$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GenerateIngredientsListOutputSchema"]
    },
    prompt: `You are a chef. Generate a list of ingredients needed for the dish "{{dishName}}" for {{numberOfServings}} servings.

IMPORTANT:
- The language of the ingredient names and units must always match the language of the dish name. If the dish name is in German, all ingredient names and units must be in German. If the dish name is in English, use English. Do not translate or mix languages.
- Always include the main protein or key ingredient (e.g., if the dish is "Palak Chicken" or "Chicken Palak", always include "Chicken" as an ingredient).

For each ingredient, provide its name, quantity (as a number), and unit (e.g., "g", "ml", "pcs", "kg").
Never return a quantity of 0. If unsure, estimate a typical amount for one serving based on common recipes or chef experience.
Return the output as a JSON object with a single key "ingredients".
The "ingredients" key should have a value of an array of objects, where each object has "name" (string), "quantity" (number), and "unit" (string) fields.
Be as accurate as possible.

Example (English):
{
  "ingredients": [
    { "name": "Chicken Breast", "quantity": 200, "unit": "g" },
    { "name": "Spinach", "quantity": 150, "unit": "g" },
    { "name": "Onion", "quantity": 50, "unit": "g" }
  ]
}

Example (German):
{
  "ingredients": [
    { "name": "Hähnchenbrust", "quantity": 200, "unit": "g" },
    { "name": "Spinat", "quantity": 150, "unit": "g" },
    { "name": "Zwiebel", "quantity": 50, "unit": "g" }
  ]
}

Ensure the output strictly follows this JSON format.`
});
const generateIngredientsListFlow = __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$genkit$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ai"].defineFlow({
    name: 'generateIngredientsListFlow',
    inputSchema: __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$ingredient$2d$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GenerateIngredientsListInputSchema"],
    outputSchema: __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$ingredient$2d$types$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GenerateIngredientsListOutputSchema"]
}, async (input)=>{
    const { output } = await prompt(input);
    if (!output) {
        throw new Error('AI did not return an output.');
    }
    return output;
});
async function generateIngredientsList(input) {
    return generateIngredientsListFlow(input);
}
;
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$validate$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ensureServerEntryExports"])([
    generateIngredientsList
]);
(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$server$2d$reference$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["registerServerReference"])(generateIngredientsList, "4079b6b9abb8c7b682ab09d09cf1810f6f192164f9", null);
}}),
"[project]/src/lib/aiMenuExtractor.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "extractMenuFromPdf": (()=>extractMenuFromPdf),
    "extractMenuItemsFromPdfWithGemini": (()=>extractMenuItemsFromPdfWithGemini)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$genkit$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/ai/genkit.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jsonrepair$2f$lib$2f$esm$2f$regular$2f$jsonrepair$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/jsonrepair/lib/esm/regular/jsonrepair.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$inventoryService$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/inventoryService.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$menuService$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/menuService.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$generate$2d$ingredients$2d$list$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/ai/flows/generate-ingredients-list.ts [app-route] (ecmascript)");
;
;
;
;
;
/**
 * Last-ditch recovery for broken, truncated Gemini arrays.
 * Cuts off after last valid object and closes with a bracket.
 */ function recoverLongestValidArray(jsonString) {
    jsonString = jsonString.replace(/,\s*([\]}])/g, '$1');
    let arrStart = jsonString.indexOf('[');
    let lastObjClose = jsonString.lastIndexOf('}');
    if (arrStart === -1 || lastObjClose === -1 || lastObjClose < arrStart) return '[]';
    let cut = jsonString.slice(arrStart, lastObjClose + 1);
    if (!cut.trim().endsWith(']')) cut += "\n]\n";
    return cut;
}
/**
 * Helper for batching with concurrency limit
 */ async function batchWithConcurrencyLimit(items, fn, limit) {
    const results = [];
    let idx = 0;
    const executing = [];
    async function run(item, i) {
        results[i] = await fn(item);
    }
    while(idx < items.length){
        const i = idx;
        const p = run(items[i], i);
        executing.push(p);
        idx++;
        if (executing.length >= limit) {
            await Promise.race(executing);
            // Remove finished
            for(let j = executing.length - 1; j >= 0; j--){
                if (typeof executing[j]?.then === 'function') {
                    executing.splice(j, 1);
                }
            }
        }
    }
    await Promise.all(executing);
    return results;
}
async function extractMenuFromPdf({ pdfDataUri, userId, numberOfServings = 1 }) {
    const prompt = `
You are an expert at reading restaurant menu PDFs in any language (e.g., German, English, French, etc.). Extract every dish, drink, or menu item as a JSON object.

For each menu item, extract:
- "name": Dish or beverage name, exactly as printed, but **never include the price or currency in the name**. The name must NOT contain any price or currency. Only the actual name, in the original language.
- "price": The price string for the item (e.g., "3,20 €", "2.50 EUR", "$4.00"). If no price, use an empty string.
- "category": Section/category name (e.g., "Pizza", "Biere", "Salate", "Getränke (Drinks)"). If not shown, use "Other". Always preserve the original language.
- "ingredients": Array of ingredient names if shown in menu. If not listed, use [].

**If a menu item has multiple variants (e.g., sizes or volumes with different prices), group all variants under a single menu item object. Add a 'sizes' array: each entry should have 'size' (exactly as shown in the menu, e.g., '0.3 l') and 'price'. Do not convert, round, or change the size string.**

**Return only a single valid JSON array of objects.** No explanations, no markdown, no text before or after the array.

Example output:
[
  {"name":"Coca-Cola","category":"Soft Drinks","sizes":[{"size":"0.3 l","price":"2,00 €"},{"size":"0.5 l","price":"3,00 €"},{"size":"1.0 l","price":"5,00 €"}],"ingredients":[]},
  {"name":"Zwiefalter-Engele, helles Bier","price":"3,20 €","category":"Biere","ingredients":[], "size": "0,33l"},
  {"name":"Zwiefalter-Urweizen Dunkel","price":"4,20 €","category":"Biere","ingredients":[], "size": "0,5l"},
  {"name":"Water Bottle","price":"2,00 €","category":"Getränke (Drinks)","ingredients":[], "size": "0,3l"},
  {"name":"Water Bottle","price":"3,00 €","category":"Getränke (Drinks)","ingredients":[], "size": "0,5l"},
  {"name":"Chicken Curry","price":"10,00 €","category":"Spezialitäten vom Huhn mit Reis","ingredients":[]},
  {"name":"Chicken Korma","price":"10,00 €","category":"Spezialitäten vom Huhn mit Reis","ingredients":["Mandeln", "Sahne", "Kokosnuss", "feinen Gewürzen"]},
  {"name":"Glas Prosecco 15% vol","price":"5,90 €","category":"Aperitifs","ingredients":[], "size": "0,2l"},
  {"name":"Indischer Weißwein","price":"6,90 €","category":"Indische Weine","ingredients":[], "size": "0,2l"},
  {"name":"Indischer Weißwein","price":"21,00 €","category":"Indische Weine","ingredients":[], "size": "0,75l"}
]

// BAD EXAMPLE (do NOT do this!):
// {"name": "Water Bottle (0,3l) 2,00 € (0,5l) 3,00 €", "price": "", ...}
`;
    // Call Gemini via Genkit
    const result = await __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$genkit$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ai"].generate([
        {
            text: prompt
        },
        {
            media: {
                url: pdfDataUri
            }
        }
    ]);
    console.log('GENKIT RAW RESULT:', result);
    // Extract text, from code block or raw
    let text = typeof result.text === 'string' ? result.text : '';
    let cleanText = '';
    const jsonMatch = text.match(/```json([\s\S]*?)```/) || text.match(/```([\s\S]*?)```/);
    if (jsonMatch) {
        cleanText = jsonMatch[1].trim();
    } else {
        cleanText = text.trim();
    }
    // Remove trailing code fences and comments, just in case
    cleanText = cleanText.replace(/```/g, '').replace(/^\s*\/\/.*$/gm, '').trim();
    // DEBUG: See what we are trying to parse
    console.log('CLEAN JSON TO PARSE:', cleanText);
    let items = [];
    try {
        // 1. Try straight parse
        items = JSON.parse(cleanText);
    } catch (e) {
        // 2. Try jsonrepair
        try {
            items = JSON.parse((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jsonrepair$2f$lib$2f$esm$2f$regular$2f$jsonrepair$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["jsonrepair"])(cleanText));
        } catch (e2) {
            // 3. Try best-effort recovery for truncation
            try {
                const partial = recoverLongestValidArray(cleanText);
                items = JSON.parse(partial);
            } catch (e3) {
                // 4. Give up, show nothing
                items = [];
            }
        }
    }
    // Post-process: If a single item contains multiple variants in price or name, split them into separate items
    const variantRegex = /([0-9]+[\.,][0-9]+\s*(l|cl|ml|g|kg|L|CL|ML|G|KG)?)[^\d]*(\d+[\.,]\d+\s*(€|EUR|USD|GBP|\$))/gi;
    let expanded = [];
    for (const item of items){
        if (item && typeof item.price === 'string' && variantRegex.test(item.price)) {
            // e.g. price: "(0,3l) 2,00 € (0,5l) 3,00 €"
            const matches = [
                ...item.price.matchAll(variantRegex)
            ];
            if (matches.length > 1) {
                for (const match of matches){
                    expanded.push({
                        ...item,
                        price: match[3].trim(),
                        size: match[1].trim()
                    });
                }
                continue;
            }
        }
        expanded.push(item);
    }
    // Post-process: If price is missing but name contains a price, extract it
    const priceRegex = /[-–—]\s*(\d+[\.,]\d+)\s*(EUR|USD|GBP|€|\$)?/i;
    const processed = Array.isArray(expanded) ? expanded.map((item)=>{
        if (item && typeof item.name === 'string' && (!item.price || item.price === '')) {
            const match = item.name.match(priceRegex);
            if (match) {
                const priceStr = match[1] + (match[2] ? ' ' + match[2] : '');
                return {
                    ...item,
                    price: priceStr.trim(),
                    name: item.name.replace(priceRegex, '').trim().replace(/[-–—]\s*$/, '').trim()
                };
            }
        }
        return item;
    }) : [];
    // Only filter for valid name field
    const filtered = Array.isArray(processed) ? processed.filter((item)=>item && typeof item.name === 'string' && item.name.length > 0) : [];
    // Merge items with same name/category into a single object with sizes array
    const mergedMap = new Map();
    for (const item of filtered){
        const key = `${item.name}||${item.category}`;
        if (!mergedMap.has(key)) {
            // Start new entry
            mergedMap.set(key, {
                ...item,
                sizes: item.size || item.sizes ? [] : undefined
            });
        }
        const merged = mergedMap.get(key);
        // If item has size/price, add to sizes array
        if (item.size || item.price && item.price !== '') {
            if (!merged.sizes) merged.sizes = [];
            merged.sizes.push({
                size: item.size || item.sizes && item.sizes[0]?.size || '',
                price: item.price || item.sizes && item.sizes[0]?.price || ''
            });
        }
    }
    // Finalize merged list
    const merged = Array.from(mergedMap.values()).map((item)=>{
        if (item.sizes && item.sizes.length === 1 && (!item.sizes[0].size || item.sizes[0].size.trim() === '')) {
            // Only one size and it's empty: move price to top-level
            return {
                ...item,
                price: item.sizes[0].price,
                sizes: undefined
            };
        } else if (item.sizes && item.sizes.length > 0) {
            // Remove top-level price/size if multiple sizes
            const { price, size, ...rest } = item;
            return {
                ...rest,
                sizes: item.sizes
            };
        } else {
            // Single size or no sizes
            return item;
        }
    });
    // After merging and before returning, ensure every item has a unique id
    const mergedWithIds = merged.map((item)=>{
        if (item.id && typeof item.id === 'string' && item.id.length > 0) return item;
        // Generate a unique id from name, category, price, and size (if present)
        let id = `${item.name}__${item.category}`;
        if (item.price) id += `__${item.price}`;
        if (item.size) id += `__${item.size}`;
        if (item.sizes && Array.isArray(item.sizes) && item.sizes.length > 0) {
            id += '__' + item.sizes.map((sz)=>`${sz.size}_${sz.price}`).join('__');
        }
        return {
            ...item,
            id
        };
    });
    // Ingredient enrichment logic
    let inventory = [];
    let menuDishes = [];
    if (userId) {
        try {
            inventory = (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$inventoryService$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getInventory"])(userId);
        } catch  {}
        try {
            menuDishes = (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$menuService$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getDishes"])(userId);
        } catch  {}
    }
    // Helper to find ingredient with quantity in inventory or menu
    function findIngredientWithQuantity(ingredientName) {
        // Check inventory
        if (inventory && Array.isArray(inventory)) {
            const inv = inventory.find((i)=>i.name.toLowerCase() === ingredientName.toLowerCase());
            if (inv && inv.quantity && inv.unit) {
                return {
                    name: inv.name,
                    quantity: inv.quantity,
                    unit: inv.unit
                };
            }
        }
        // Check menu
        if (menuDishes && Array.isArray(menuDishes)) {
            for (const dish of menuDishes){
                if (dish.ingredients && Array.isArray(dish.ingredients)) {
                    for (const ing of dish.ingredients){
                        if (typeof ing === 'object' && ing.inventoryItemName && ing.inventoryItemName.toLowerCase() === ingredientName.toLowerCase()) {
                            return {
                                name: ing.inventoryItemName,
                                quantity: ing.quantityPerDish,
                                unit: ing.unit
                            };
                        }
                    }
                }
            }
        }
        return null;
    }
    // Collect all AI ingredient generation tasks
    const aiTasks = [];
    for(let i = 0; i < mergedWithIds.length; i++){
        const item = mergedWithIds[i];
        if (item.ingredients && Array.isArray(item.ingredients) && item.ingredients.length > 0) {
            const missing = [];
            for (const ing of item.ingredients){
                let found = findIngredientWithQuantity(ing);
                if (!found) missing.push(ing);
            }
            if (missing.length > 0) {
                aiTasks.push({
                    idx: i,
                    name: item.name,
                    missing
                });
            }
        } else if (item.name) {
            aiTasks.push({
                idx: i,
                name: item.name,
                missing: []
            });
        }
    }
    // Batch AI calls for ingredient generation (concurrency limit 5)
    const aiResults = await batchWithConcurrencyLimit(aiTasks, async (task)=>{
        try {
            return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$ai$2f$flows$2f$generate$2d$ingredients$2d$list$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["generateIngredientsList"])({
                dishName: task.name,
                numberOfServings
            });
        } catch  {
            return {
                ingredients: []
            };
        }
    }, 5);
    // Map AI results back to menu items
    for(let i = 0; i < aiTasks.length; i++){
        const { idx, missing } = aiTasks[i];
        const aiResult = aiResults[i];
        if (!mergedWithIds[idx].ingredients || mergedWithIds[idx].ingredients.length === 0) {
            // No ingredients, use full AI list
            // Normalize to { inventoryItemName, quantityPerDish, unit }
            mergedWithIds[idx].ingredients = aiResult.ingredients.map((ing)=>({
                    inventoryItemName: ing.name,
                    quantityPerDish: ing.quantity,
                    unit: ing.unit
                }));
        } else {
            // If original ingredients are just names (strings), and AI returns objects, use AI's list directly
            if (Array.isArray(mergedWithIds[idx].ingredients) && mergedWithIds[idx].ingredients.every((ing)=>typeof ing === 'string') && Array.isArray(aiResult.ingredients) && aiResult.ingredients.length > 0 && aiResult.ingredients.every((aii)=>typeof aii === 'object' && 'name' in aii && 'quantity' in aii && 'unit' in aii)) {
                mergedWithIds[idx].ingredients = aiResult.ingredients;
            } else {
                // Only fill in missing ingredients
                const enriched = [];
                for (const ing of mergedWithIds[idx].ingredients){
                    let found = findIngredientWithQuantity(ing);
                    if (found) {
                        enriched.push(found);
                    } else {
                        // Find in AI result
                        const aiIng = aiResult.ingredients.find((aii)=>aii.name.toLowerCase() === (typeof ing === 'string' ? ing.toLowerCase() : ''));
                        if (aiIng) {
                            enriched.push(aiIng);
                        } else {
                            enriched.push({
                                name: typeof ing === 'string' ? ing : '',
                                quantity: 0,
                                unit: ''
                            });
                        }
                    }
                }
                // Normalize to { inventoryItemName, quantityPerDish, unit }
                mergedWithIds[idx].ingredients = enriched.map((ing)=>({
                        inventoryItemName: ing.name,
                        quantityPerDish: ing.quantity,
                        unit: ing.unit
                    }));
            }
        }
    }
    return mergedWithIds;
}
async function extractMenuItemsFromPdfWithGemini(buffer) {
    // Convert buffer to data URI
    const pdfDataUri = `data:application/pdf;base64,${buffer.toString('base64')}`;
    const items = await extractMenuFromPdf({
        pdfDataUri
    });
    return items;
}
}}),
"[project]/src/app/api/menuCsv/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "GET": (()=>GET),
    "POST": (()=>POST),
    "runtime": (()=>runtime)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$csv$2d$parse$2f$lib$2f$sync$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/csv-parse/lib/sync.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$csv$2d$parse$2f$lib$2f$sync$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/csv-parse/lib/sync.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$aiMenuExtractor$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/aiMenuExtractor.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/fs [external] (fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/path [external] (path, cjs)");
;
;
;
;
;
const MENU_JSON_PATH = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(process.cwd(), 'menu-data.json');
async function GET() {
    // Return saved menu items for Order Entry
    try {
        if (__TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].existsSync(MENU_JSON_PATH)) {
            const data = __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].readFileSync(MENU_JSON_PATH, 'utf-8');
            const menu = JSON.parse(data);
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                menu
            });
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            menu: []
        });
    } catch (err) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            menu: []
        });
    }
}
const runtime = 'nodejs'; // Ensure Node.js APIs are available
async function POST(request) {
    // If JSON, handle save or delete
    const url = new URL(request.url, 'http://localhost');
    const action = url.searchParams.get('action');
    if (action === 'delete') {
        if (__TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].existsSync(MENU_JSON_PATH)) {
            __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].unlinkSync(MENU_JSON_PATH);
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            success: true
        });
    }
    const contentType = request.headers.get('content-type') || '';
    if (contentType.includes('application/json')) {
        const body = await request.json();
        if (body.action === 'save' && Array.isArray(body.menuItems)) {
            // Save menuItems to file
            __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].writeFileSync(MENU_JSON_PATH, JSON.stringify(body.menuItems, null, 2), 'utf-8');
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                success: true
            });
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: 'Invalid save request'
        }, {
            status: 400
        });
    }
    const formData = await request.formData();
    const file = formData.get('file');
    if (!file || typeof file === 'string') {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: 'No file uploaded.'
        }, {
            status: 400
        });
    }
    const arrayBuffer = await file.arrayBuffer();
    const buffer = Buffer.from(arrayBuffer);
    const filename = file.name || '';
    const isPdf = filename.toLowerCase().endsWith('.pdf');
    const isCsv = filename.toLowerCase().endsWith('.csv');
    let menuItems = [];
    try {
        if (isPdf) {
            // Use Gemini for PDF extraction
            menuItems = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$aiMenuExtractor$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["extractMenuItemsFromPdfWithGemini"])(buffer);
        } else if (isCsv) {
            // Parse CSV
            const csvText = buffer.toString('utf-8');
            menuItems = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$csv$2d$parse$2f$lib$2f$sync$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["parse"])(csvText, {
                columns: true,
                skip_empty_lines: true
            });
        } else {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Unsupported file type. Please upload a PDF or CSV.'
            }, {
                status: 400
            });
        }
        // Do NOT write extracted menuItems to file here (revert to old flow)
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            menuItems
        });
    } catch (error) {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: error.message || 'Failed to extract menu items.'
        }, {
            status: 500
        });
    }
}
// Function to clean menu item names by removing price information
function cleanMenuItemName(name) {
    if (!name) return name;
    // Remove price patterns like "- 12.90 EUR", "- $12.90", "- 12.90", "- 12.90"
    return name.replace(/\s*-\s*\d+[\.,]\d+\s*(EUR|USD|GBP|  |$  |  )\s*$/i, '') // Remove "- 12.90 EUR" patterns
    .replace(/\s*-\s*\d+[\.,]\d+\s*$/i, '') // Remove "- 12.90" patterns  
    .replace(/\s*\(\d+[\.,]\d+\s*(EUR|USD|GBP|  |$  |  )\)\s*$/i, '') // Remove "(12.90 EUR)" patterns
    .replace(/\s*\$\d+[\.,]\d+\s*$/i, '') // Remove "$12.90" patterns
    .replace(/\s*  \d+[\.,]\d+\s*$/i, '') // Remove " 12.90" patterns
    .replace(/\s*  \d+[\.,]\d+\s*$/i, '') // Remove " 12.90" patterns
    .trim();
} // ... (rest of the code from the Noman branch version) ... 
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__210c4ef3._.js.map