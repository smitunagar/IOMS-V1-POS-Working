{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/alvi/IOMS/IOMS_V1_POS_Working_main_20_08_2025/src/app/api/tables/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport fs from 'fs';\nimport path from 'path';\n\nconst TABLES_FILE = path.resolve(process.cwd(), 'src/lib/tables.json');\n\nfunction readTables() {\n  try {\n    const data = fs.readFileSync(TABLES_FILE, 'utf-8');\n    return JSON.parse(data);\n  } catch {\n    return [];\n  }\n}\n\nfunction writeTables(tables: any[]) {\n  fs.writeFileSync(TABLES_FILE, JSON.stringify(tables, null, 2), 'utf-8');\n}\n\nexport async function GET(req: NextRequest) {\n  console.log('[API] /api/tables GET called at', new Date().toISOString(), '\\nStack:', new Error().stack);\n  const tables = readTables();\n  return NextResponse.json({ tables });\n}\n\nexport async function POST(req: NextRequest) {\n  console.log('[API] /api/tables POST called at', new Date().toISOString(), '\\nStack:', new Error().stack);\n  try {\n    const body = await req.json();\n    const { action, tableId, number, capacity } = body;\n    const tables = readTables();\n\n    if (action === 'add') {\n      if (!number || !capacity) {\n        return NextResponse.json({ error: 'Missing number or capacity' }, { status: 400 });\n      }\n      const newTable = {\n        id: Date.now().toString(),\n        number: String(number),\n        capacity: Number(capacity),\n        status: 'available',\n        waiter: null,\n        occupiedSince: null\n      };\n      tables.push(newTable);\n      writeTables(tables);\n      return NextResponse.json({ tables });\n    }\n\n    if (!tableId) {\n      return NextResponse.json({ error: 'Missing tableId' }, { status: 400 });\n    }\n    const table = tables.find((t: any) => t.id === tableId);\n    if (!table) {\n      return NextResponse.json({ error: 'Table not found' }, { status: 404 });\n    }\n    if (action === 'occupy') {\n      table.status = 'occupied';\n      table.occupiedSince = new Date().toISOString();\n      if (body.waiter) table.waiter = body.waiter;\n    } else if (action === 'free') {\n      table.status = 'available';\n      table.occupiedSince = null;\n      table.waiter = null;\n    }\n    if (action === 'edit') {\n      if (!number || !capacity) {\n        return NextResponse.json({ error: 'Missing number or capacity' }, { status: 400 });\n      }\n      table.number = String(number);\n      table.capacity = Number(capacity);\n      if ('waiter' in body) table.waiter = body.waiter;\n      if ('occupiedSince' in body) table.occupiedSince = body.occupiedSince;\n      writeTables(tables);\n      return NextResponse.json({ tables });\n    }\n    if (action === 'delete') {\n      const idx = tables.findIndex((t: any) => t.id === tableId);\n      if (idx === -1) {\n        return NextResponse.json({ error: 'Table not found' }, { status: 404 });\n      }\n      tables.splice(idx, 1);\n      writeTables(tables);\n      return NextResponse.json({ tables });\n    }\n    writeTables(tables);\n    return NextResponse.json({ tables });\n  } catch (error) {\n    return NextResponse.json({ error: 'Invalid request' }, { status: 400 });\n  }\n} "],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,cAAc,iGAAA,CAAA,UAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI;AAEhD,SAAS;IACP,IAAI;QACF,MAAM,OAAO,6FAAA,CAAA,UAAE,CAAC,YAAY,CAAC,aAAa;QAC1C,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEA,SAAS,YAAY,MAAa;IAChC,6FAAA,CAAA,UAAE,CAAC,aAAa,CAAC,aAAa,KAAK,SAAS,CAAC,QAAQ,MAAM,IAAI;AACjE;AAEO,eAAe,IAAI,GAAgB;IACxC,QAAQ,GAAG,CAAC,mCAAmC,IAAI,OAAO,WAAW,IAAI,YAAY,IAAI,QAAQ,KAAK;IACtG,MAAM,SAAS;IACf,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;QAAE;IAAO;AACpC;AAEO,eAAe,KAAK,GAAgB;IACzC,QAAQ,GAAG,CAAC,oCAAoC,IAAI,OAAO,WAAW,IAAI,YAAY,IAAI,QAAQ,KAAK;IACvG,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG;QAC9C,MAAM,SAAS;QAEf,IAAI,WAAW,OAAO;YACpB,IAAI,CAAC,UAAU,CAAC,UAAU;gBACxB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAA6B,GAAG;oBAAE,QAAQ;gBAAI;YAClF;YACA,MAAM,WAAW;gBACf,IAAI,KAAK,GAAG,GAAG,QAAQ;gBACvB,QAAQ,OAAO;gBACf,UAAU,OAAO;gBACjB,QAAQ;gBACR,QAAQ;gBACR,eAAe;YACjB;YACA,OAAO,IAAI,CAAC;YACZ,YAAY;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE;YAAO;QACpC;QAEA,IAAI,CAAC,SAAS;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QACA,MAAM,QAAQ,OAAO,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK;QAC/C,IAAI,CAAC,OAAO;YACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QACA,IAAI,WAAW,UAAU;YACvB,MAAM,MAAM,GAAG;YACf,MAAM,aAAa,GAAG,IAAI,OAAO,WAAW;YAC5C,IAAI,KAAK,MAAM,EAAE,MAAM,MAAM,GAAG,KAAK,MAAM;QAC7C,OAAO,IAAI,WAAW,QAAQ;YAC5B,MAAM,MAAM,GAAG;YACf,MAAM,aAAa,GAAG;YACtB,MAAM,MAAM,GAAG;QACjB;QACA,IAAI,WAAW,QAAQ;YACrB,IAAI,CAAC,UAAU,CAAC,UAAU;gBACxB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAA6B,GAAG;oBAAE,QAAQ;gBAAI;YAClF;YACA,MAAM,MAAM,GAAG,OAAO;YACtB,MAAM,QAAQ,GAAG,OAAO;YACxB,IAAI,YAAY,MAAM,MAAM,MAAM,GAAG,KAAK,MAAM;YAChD,IAAI,mBAAmB,MAAM,MAAM,aAAa,GAAG,KAAK,aAAa;YACrE,YAAY;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE;YAAO;QACpC;QACA,IAAI,WAAW,UAAU;YACvB,MAAM,MAAM,OAAO,SAAS,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK;YAClD,IAAI,QAAQ,CAAC,GAAG;gBACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAkB,GAAG;oBAAE,QAAQ;gBAAI;YACvE;YACA,OAAO,MAAM,CAAC,KAAK;YACnB,YAAY;YACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE;YAAO;QACpC;QACA,YAAY;QACZ,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE;QAAO;IACpC,EAAE,OAAO,OAAO;QACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAkB,GAAG;YAAE,QAAQ;QAAI;IACvE;AACF","debugId":null}}]
}