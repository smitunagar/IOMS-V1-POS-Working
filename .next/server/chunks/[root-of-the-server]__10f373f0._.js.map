{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/alvi/IOMS/IOMS_V1_POS_Working_main_20_08_2025/src/ai/genkit.ts"],"sourcesContent":["import {genkit} from 'genkit';\r\nimport {googleAI} from '@genkit-ai/googleai';\r\n\r\nexport const ai = genkit({\r\n  plugins: [googleAI()],\r\n  model: 'googleai/gemini-1.5-flash',\r\n}); "],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,MAAM,KAAK,IAAA,mJAAM,EAAC;IACvB,SAAS;QAAC,IAAA,yLAAQ;KAAG;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 242, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/alvi/IOMS/IOMS_V1_POS_Working_main_20_08_2025/src/app/api/ai-allergen/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { ai } from '@/ai/genkit';\r\n\r\nasync function generateAllergenList(input: { dishName: string; aiHint?: string }) {\r\n  const { dishName, aiHint } = input;\r\n  const prompt = `You are a food safety expert. For the dish: \"${dishName}\", list the most likely food allergens present. Use compact emojis/icons for each allergen (e.g., ü•õ for milk, ü•ú for peanuts, üåæ for gluten, ü•ö for egg, üêü for fish, ü¶ê for shellfish, üå∞ for tree nuts, üçë for soy, üçØ for sesame, üå∂Ô∏è for spicy, üçã for citrus, etc). For each allergen, return an object with 'icon' and 'name' (the full allergen name in English or the menu language). ${aiHint ? `Context: ${aiHint}` : ''}\r\nReturn ONLY a valid JSON array of objects: [{\"icon\": \"emoji\", \"name\": \"allergen name\"}, ...]. No explanations, no markdown, just the JSON array.`;\r\n  try {\r\n    const result = await ai.generate([{ text: prompt }]);\r\n    let text = typeof result.text === 'string' ? result.text : '';\r\n    let cleanText = text.trim();\r\n    const jsonMatch = text.match(/```json([\\s\\S]*?)```/) || text.match(/```([\\s\\S]*?)```/);\r\n    if (jsonMatch) {\r\n      cleanText = jsonMatch[1].trim();\r\n    }\r\n    cleanText = cleanText.replace(/```/g, '').trim();\r\n    const allergens = JSON.parse(cleanText);\r\n    if (!Array.isArray(allergens)) throw new Error('Invalid response format');\r\n    return { allergens };\r\n  } catch (error) {\r\n    console.error('AI allergen generation failed:', error);\r\n    // Fallback: common allergens\r\n    const fallbackAllergens = [\r\n      { icon: 'üåæ', name: 'Gluten' },\r\n      { icon: 'ü•õ', name: 'Milk' },\r\n      { icon: 'ü•ö', name: 'Egg' },\r\n      { icon: 'ü•ú', name: 'Peanut' },\r\n      { icon: 'üå∞', name: 'Tree nut' },\r\n      { icon: 'üçë', name: 'Soy' },\r\n      { icon: 'üçØ', name: 'Sesame' },\r\n      { icon: 'üêü', name: 'Fish' },\r\n      { icon: 'ü¶ê', name: 'Shellfish' },\r\n      { icon: 'üå∂Ô∏è', name: 'Spicy' }\r\n    ];\r\n    return { allergens: fallbackAllergens };\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json();\r\n    const { name, aiHint } = body;\r\n    if (!name) {\r\n      return NextResponse.json({ error: 'Missing dish name' }, { status: 400 });\r\n    }\r\n    const result = await generateAllergenList({ dishName: name, aiHint });\r\n    return NextResponse.json({ allergens: result.allergens });\r\n  } catch (error: any) {\r\n    return NextResponse.json({ error: error?.message || 'Failed to generate allergens' }, { status: 500 });\r\n  }\r\n} "],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,eAAe,qBAAqB,KAA4C;IAC9E,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG;IAC7B,MAAM,SAAS,CAAC,6CAA6C,EAAE,SAAS,+XAA+X,EAAE,SAAS,CAAC,SAAS,EAAE,QAAQ,GAAG,GAAG;gJAC9V,CAAC;IAC/I,IAAI;QACF,MAAM,SAAS,MAAM,2HAAE,CAAC,QAAQ,CAAC;YAAC;gBAAE,MAAM;YAAO;SAAE;QACnD,IAAI,OAAO,OAAO,OAAO,IAAI,KAAK,WAAW,OAAO,IAAI,GAAG;QAC3D,IAAI,YAAY,KAAK,IAAI;QACzB,MAAM,YAAY,KAAK,KAAK,CAAC,2BAA2B,KAAK,KAAK,CAAC;QACnE,IAAI,WAAW;YACb,YAAY,SAAS,CAAC,EAAE,CAAC,IAAI;QAC/B;QACA,YAAY,UAAU,OAAO,CAAC,QAAQ,IAAI,IAAI;QAC9C,MAAM,YAAY,KAAK,KAAK,CAAC;QAC7B,IAAI,CAAC,MAAM,OAAO,CAAC,YAAY,MAAM,IAAI,MAAM;QAC/C,OAAO;YAAE;QAAU;IACrB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,6BAA6B;QAC7B,MAAM,oBAAoB;YACxB;gBAAE,MAAM;gBAAM,MAAM;YAAS;YAC7B;gBAAE,MAAM;gBAAM,MAAM;YAAO;YAC3B;gBAAE,MAAM;gBAAM,MAAM;YAAM;YAC1B;gBAAE,MAAM;gBAAM,MAAM;YAAS;YAC7B;gBAAE,MAAM;gBAAM,MAAM;YAAW;YAC/B;gBAAE,MAAM;gBAAM,MAAM;YAAM;YAC1B;gBAAE,MAAM;gBAAM,MAAM;YAAS;YAC7B;gBAAE,MAAM;gBAAM,MAAM;YAAO;YAC3B;gBAAE,MAAM;gBAAM,MAAM;YAAY;YAChC;gBAAE,MAAM;gBAAO,MAAM;YAAQ;SAC9B;QACD,OAAO;YAAE,WAAW;QAAkB;IACxC;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG;QACzB,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QACA,MAAM,SAAS,MAAM,qBAAqB;YAAE,UAAU;YAAM;QAAO;QACnE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,WAAW,OAAO,SAAS;QAAC;IACzD,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,OAAO,WAAW;QAA+B,GAAG;YAAE,QAAQ;QAAI;IACtG;AACF","debugId":null}}]
}