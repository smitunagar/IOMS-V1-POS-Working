(()=>{var e={};e.id=4710,e.ids=[4710],e.modules={14464:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=14464,e.exports=r},12308:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=12308,e.exports=r},66860:e=>{"use strict";e.exports=require("express")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},61212:e=>{"use strict";e.exports=require("async_hooks")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},18139:e=>{"use strict";e.exports=require("dgram")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},20629:e=>{"use strict";e.exports=require("fs/promises")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},85807:e=>{"use strict";e.exports=require("module")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},96119:e=>{"use strict";e.exports=require("perf_hooks")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},92761:e=>{"use strict";e.exports=require("node:async_hooks")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},15200:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},38846:e=>{"use strict";e.exports=require("node:perf_hooks")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},18177:()=>{},85418:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>q,requestAsyncStorage:()=>x,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{POST:()=>p});var i=t(49303),o=t(88716),u=t(60670),n=t(87070),a=t(67174);async function c(e){let{dishName:r,aiHint:t}=e,s=`You are a food safety expert. For the dish: "${r}", list the most likely food allergens present. Use compact emojis/icons for each allergen (e.g., ðŸ¥› for milk, ðŸ¥œ for peanuts, ðŸŒ¾ for gluten, ðŸ¥š for egg, ðŸŸ for fish, ðŸ¦ for shellfish, ðŸŒ° for tree nuts, ðŸ‘ for soy, ðŸ¯ for sesame, ðŸŒ¶ï¸ for spicy, ðŸ‹ for citrus, etc). For each allergen, return an object with 'icon' and 'name' (the full allergen name in English or the menu language). ${t?`Context: ${t}`:""}
Return ONLY a valid JSON array of objects: [{"icon": "emoji", "name": "allergen name"}, ...]. No explanations, no markdown, just the JSON array.`;try{let e=await a.ai.generate([{text:s}]),r="string"==typeof e.text?e.text:"",t=r.trim(),i=r.match(/```json([\s\S]*?)```/)||r.match(/```([\s\S]*?)```/);i&&(t=i[1].trim()),t=t.replace(/```/g,"").trim();let o=JSON.parse(t);if(!Array.isArray(o))throw Error("Invalid response format");return{allergens:o}}catch(e){return console.error("AI allergen generation failed:",e),{allergens:[{icon:"\uD83C\uDF3E",name:"Gluten"},{icon:"\uD83E\uDD5B",name:"Milk"},{icon:"\uD83E\uDD5A",name:"Egg"},{icon:"\uD83E\uDD5C",name:"Peanut"},{icon:"\uD83C\uDF30",name:"Tree nut"},{icon:"\uD83C\uDF51",name:"Soy"},{icon:"\uD83C\uDF6F",name:"Sesame"},{icon:"\uD83D\uDC1F",name:"Fish"},{icon:"\uD83E\uDD90",name:"Shellfish"},{icon:"\uD83C\uDF36ï¸",name:"Spicy"}]}}}async function p(e){try{let{name:r,aiHint:t}=await e.json();if(!r)return n.NextResponse.json({error:"Missing dish name"},{status:400});let s=await c({dishName:r,aiHint:t});return n.NextResponse.json({allergens:s.allergens})}catch(e){return n.NextResponse.json({error:e?.message||"Failed to generate allergens"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/ai-allergen/route",pathname:"/api/ai-allergen",filename:"route",bundlePath:"app/api/ai-allergen/route"},resolvedPagePath:"/Users/nishantchaturvedi/Desktop/IOMS/IOMS-V1-POS-Working/src/app/api/ai-allergen/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:d,serverHooks:m}=l,h="/api/ai-allergen/route";function q(){return(0,u.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},67174:(e,r,t)=>{"use strict";t.d(r,{ai:()=>o});var s=t(44252),i=t(40654);let o=(0,s.genkit)({plugins:[(0,i.LI)()],model:"googleai/gemini-2.0-flash"})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,5972,3066,654],()=>t(85418));module.exports=s})();