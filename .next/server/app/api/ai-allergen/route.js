(()=>{var e={};e.id=8847,e.ids=[8847],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},11997:e=>{"use strict";e.exports=require("punycode")},12412:e=>{"use strict";e.exports=require("assert")},13846:(e,r,t)=>{"use strict";t.d(r,{ai:()=>o});var s=t(97955),i=t(5757);let o=(0,s.genkit)({plugins:[(0,i.YF)()],model:"googleai/gemini-2.0-flash"})},14305:e=>{"use strict";e.exports=require("diagnostics_channel")},14985:e=>{"use strict";e.exports=require("dns")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},18868:()=>{},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19185:e=>{"use strict";e.exports=require("dgram")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30558:()=>{},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},35219:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>l,serverHooks:()=>q,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>d});var s={};t.r(s),t.d(s,{POST:()=>c});var i=t(96559),o=t(48088),n=t(37719),u=t(32190),a=t(13846);async function p(e){let{dishName:r,aiHint:t}=e,s=`You are a food safety expert. For the dish: "${r}", list the most likely food allergens present. Use compact emojis/icons for each allergen (e.g., ðŸ¥› for milk, ðŸ¥œ for peanuts, ðŸŒ¾ for gluten, ðŸ¥š for egg, ðŸŸ for fish, ðŸ¦ for shellfish, ðŸŒ° for tree nuts, ðŸ‘ for soy, ðŸ¯ for sesame, ðŸŒ¶ï¸ for spicy, ðŸ‹ for citrus, etc). For each allergen, return an object with 'icon' and 'name' (the full allergen name in English or the menu language). ${t?`Context: ${t}`:""}
Return ONLY a valid JSON array of objects: [{"icon": "emoji", "name": "allergen name"}, ...]. No explanations, no markdown, just the JSON array.`;try{let e=await a.ai.generate([{text:s}]),r="string"==typeof e.text?e.text:"",t=r.trim(),i=r.match(/```json([\s\S]*?)```/)||r.match(/```([\s\S]*?)```/);i&&(t=i[1].trim()),t=t.replace(/```/g,"").trim();let o=JSON.parse(t);if(!Array.isArray(o))throw Error("Invalid response format");return{allergens:o}}catch(e){return console.error("AI allergen generation failed:",e),{allergens:[{icon:"\uD83C\uDF3E",name:"Gluten"},{icon:"\uD83E\uDD5B",name:"Milk"},{icon:"\uD83E\uDD5A",name:"Egg"},{icon:"\uD83E\uDD5C",name:"Peanut"},{icon:"\uD83C\uDF30",name:"Tree nut"},{icon:"\uD83C\uDF51",name:"Soy"},{icon:"\uD83C\uDF6F",name:"Sesame"},{icon:"\uD83D\uDC1F",name:"Fish"},{icon:"\uD83E\uDD90",name:"Shellfish"},{icon:"\uD83C\uDF36ï¸",name:"Spicy"}]}}}async function c(e){try{let{name:r,aiHint:t}=await e.json();if(!r)return u.NextResponse.json({error:"Missing dish name"},{status:400});let s=await p({dishName:r,aiHint:t});return u.NextResponse.json({allergens:s.allergens})}catch(e){return u.NextResponse.json({error:e?.message||"Failed to generate allergens"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/ai-allergen/route",pathname:"/api/ai-allergen",filename:"route",bundlePath:"app/api/ai-allergen/route"},resolvedPagePath:"/Users/nishantchaturvedi/Desktop/IOMS/IOMS-V1-POS-Working/src/app/api/ai-allergen/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:d,serverHooks:q}=l;function m(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:d})}},37067:e=>{"use strict";e.exports=require("node:http")},37830:e=>{"use strict";e.exports=require("node:stream/web")},41204:e=>{"use strict";e.exports=require("string_decoder")},44708:e=>{"use strict";e.exports=require("node:https")},44725:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=44725,e.exports=r},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},49754:()=>{},54379:e=>{"use strict";e.exports=require("node:path")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70015:()=>{},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},78335:()=>{},78474:e=>{"use strict";e.exports=require("node:events")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},84297:e=>{"use strict";e.exports=require("async_hooks")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719,580,2106,5757],()=>t(35219));module.exports=s})();