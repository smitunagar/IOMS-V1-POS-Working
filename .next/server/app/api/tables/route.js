(()=>{var e={};e.id=7761,e.ids=[7761],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},18868:()=>{},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},43435:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>g,serverHooks:()=>j,workAsyncStorage:()=>b,workUnitAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{GET:()=>S,POST:()=>f});var n=r(96559),i=r(48088),a=r(37719),o=r(32190),u=r(29021),c=r.n(u),p=r(33873);let l=r.n(p)().resolve(process.cwd(),"src/lib/tables.json");function d(){try{let e=c().readFileSync(l,"utf-8");return JSON.parse(e)}catch{return[]}}function x(e){c().writeFileSync(l,JSON.stringify(e,null,2),"utf-8")}async function S(e){console.log("[API] /api/tables GET called at",new Date().toISOString(),"\nStack:",Error().stack);let t=d();return o.NextResponse.json({tables:t})}async function f(e){console.log("[API] /api/tables POST called at",new Date().toISOString(),"\nStack:",Error().stack);try{let t=await e.json(),{action:r,tableId:s,number:n,capacity:i}=t,a=d();if("add"===r){if(!n||!i)return o.NextResponse.json({error:"Missing number or capacity"},{status:400});let e={id:Date.now().toString(),number:String(n),capacity:Number(i),status:"available",waiter:null,occupiedSince:null};return a.push(e),x(a),o.NextResponse.json({tables:a})}if(!s)return o.NextResponse.json({error:"Missing tableId"},{status:400});let u=a.find(e=>e.id===s);if(!u)return o.NextResponse.json({error:"Table not found"},{status:404});if("occupy"===r?(u.status="occupied",u.occupiedSince=new Date().toISOString(),t.waiter&&(u.waiter=t.waiter)):"free"===r&&(u.status="available",u.occupiedSince=null,u.waiter=null),"edit"===r){if(!n||!i)return o.NextResponse.json({error:"Missing number or capacity"},{status:400});return u.number=String(n),u.capacity=Number(i),"waiter"in t&&(u.waiter=t.waiter),"occupiedSince"in t&&(u.occupiedSince=t.occupiedSince),x(a),o.NextResponse.json({tables:a})}if("delete"===r){let e=a.findIndex(e=>e.id===s);if(-1===e)return o.NextResponse.json({error:"Table not found"},{status:404});return a.splice(e,1),x(a),o.NextResponse.json({tables:a})}return x(a),o.NextResponse.json({tables:a})}catch(e){return o.NextResponse.json({error:"Invalid request"},{status:400})}}let g=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/tables/route",pathname:"/api/tables",filename:"route",bundlePath:"app/api/tables/route"},resolvedPagePath:"/Users/nishantchaturvedi/Desktop/IOMS/IOMS-V1-POS-Working/src/app/api/tables/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:b,workUnitAsyncStorage:w,serverHooks:j}=g;function v(){return(0,a.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:w})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7719,580],()=>r(43435));module.exports=s})();