"use strict";(()=>{var e={};e.id=9669,e.ids=[9669],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},91283:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>N,requestAsyncStorage:()=>g,routeModule:()=>b,serverHooks:()=>j,staticGenerationAsyncStorage:()=>w});var n={};r.r(n),r.d(n,{GET:()=>f,POST:()=>x});var s=r(49303),i=r(88716),a=r(60670),o=r(87070),u=r(92048),c=r.n(u),p=r(55315);let l=r.n(p)().resolve(process.cwd(),"src/lib/tables.json");function d(){try{let e=c().readFileSync(l,"utf-8");return JSON.parse(e)}catch{return[]}}function S(e){c().writeFileSync(l,JSON.stringify(e,null,2),"utf-8")}async function f(e){console.log("[API] /api/tables GET called at",new Date().toISOString(),"\nStack:",Error().stack);let t=d();return o.NextResponse.json({tables:t})}async function x(e){console.log("[API] /api/tables POST called at",new Date().toISOString(),"\nStack:",Error().stack);try{let t=await e.json(),{action:r,tableId:n,number:s,capacity:i}=t,a=d();if("add"===r){if(!s||!i)return o.NextResponse.json({error:"Missing number or capacity"},{status:400});let e={id:Date.now().toString(),number:String(s),capacity:Number(i),status:"available",waiter:null,occupiedSince:null};return a.push(e),S(a),o.NextResponse.json({tables:a})}if(!n)return o.NextResponse.json({error:"Missing tableId"},{status:400});let u=a.find(e=>e.id===n);if(!u)return o.NextResponse.json({error:"Table not found"},{status:404});if("occupy"===r?(u.status="occupied",u.occupiedSince=new Date().toISOString(),t.waiter&&(u.waiter=t.waiter)):"free"===r&&(u.status="available",u.occupiedSince=null,u.waiter=null),"edit"===r){if(!s||!i)return o.NextResponse.json({error:"Missing number or capacity"},{status:400});return u.number=String(s),u.capacity=Number(i),"waiter"in t&&(u.waiter=t.waiter),"occupiedSince"in t&&(u.occupiedSince=t.occupiedSince),S(a),o.NextResponse.json({tables:a})}if("delete"===r){let e=a.findIndex(e=>e.id===n);if(-1===e)return o.NextResponse.json({error:"Table not found"},{status:404});return a.splice(e,1),S(a),o.NextResponse.json({tables:a})}return S(a),o.NextResponse.json({tables:a})}catch(e){return o.NextResponse.json({error:"Invalid request"},{status:400})}}let b=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/tables/route",pathname:"/api/tables",filename:"route",bundlePath:"app/api/tables/route"},resolvedPagePath:"/Users/nishantchaturvedi/Desktop/IOMS/IOMS-V1-POS-Working/src/app/api/tables/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:w,serverHooks:j}=b,m="/api/tables/route";function N(){return(0,a.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:w})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972],()=>r(91283));module.exports=n})();