(()=>{var e={};e.id=9789,e.ids=[9789],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},18868:()=>{},27153:(e,t,n)=>{"use strict";function r(e){return[]}n.d(t,{x7:()=>r})},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},86841:(e,t,n)=>{"use strict";n.r(t),n.d(t,{patchFetch:()=>w,routeModule:()=>g,serverHooks:()=>q,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>h});var r={};n.r(r),n.d(r,{GET:()=>m,PATCH:()=>y,POST:()=>p});var o=n(96559),i=n(48088),a=n(37719),s=n(32190),u=n(97904),d=n(27153);let c=[{id:"order_001",orderType:"dine-in",status:"Completed",customerInfo:{tableNumber:"1"},items:[{name:"Chicken Curry",quantity:1,unitPrice:10},{name:"Naan Bread",quantity:2,unitPrice:2}],totalAmount:14,createdAt:"2024-01-15T10:30:00Z",completedAt:"2024-01-15T11:15:00Z",paymentMode:"card",tipAmount:2,amountPaid:16},{id:"order_002",orderType:"delivery",status:"Completed",customerInfo:{name:"John Doe",address:"123 Main St"},items:[{name:"Fish Curry",quantity:1,unitPrice:10.5},{name:"Naan Bread",quantity:2,unitPrice:2}],totalAmount:14.5,createdAt:"2024-01-15T12:00:00Z",completedAt:"2024-01-15T12:45:00Z",paymentMode:"cash",tipAmount:1.5,amountPaid:16},{id:"order_003",orderType:"dine-in",status:"Completed",customerInfo:{tableNumber:"3"},items:[{name:"Lamb Korma",quantity:1,unitPrice:11},{name:"Dal Channa",quantity:1,unitPrice:10},{name:"Coca Cola",quantity:2,unitPrice:2.5}],totalAmount:26,createdAt:"2024-01-15T13:15:00Z",completedAt:"2024-01-15T14:30:00Z",paymentMode:"card",tipAmount:3,amountPaid:29},{id:"order_004",orderType:"take-away",status:"Pending",customerInfo:{name:"Sarah Johnson",phone:"+49 123 456 789"},items:[{name:"Chicken Tikka Masala",quantity:1,unitPrice:12},{name:"Rice",quantity:1,unitPrice:3},{name:"Mango Lassi",quantity:1,unitPrice:4.5}],totalAmount:19.5,createdAt:"2024-01-15T15:00:00Z"},{id:"order_005",orderType:"take-away",status:"Pending",customerInfo:{name:"Michael Chen",phone:"+49 987 654 321"},items:[{name:"Vegetable Biryani",quantity:1,unitPrice:11},{name:"Raita",quantity:1,unitPrice:2.5},{name:"Gulab Jamun",quantity:2,unitPrice:3}],totalAmount:19.5,createdAt:"2024-01-15T15:30:00Z"},{id:"order_006",orderType:"take-away",status:"Completed",customerInfo:{name:"Emma Wilson",phone:"+49 555 123 456"},items:[{name:"Butter Chicken",quantity:1,unitPrice:13},{name:"Garlic Naan",quantity:2,unitPrice:2.5},{name:"Coca Cola",quantity:1,unitPrice:2.5}],totalAmount:20.5,createdAt:"2024-01-15T14:00:00Z",completedAt:"2024-01-15T14:45:00Z",paymentMode:"cash",tipAmount:2,amountPaid:22.5}];async function l(e,t){console.log("\uD83D\uDD04 Updating inventory for order:",e.id);try{let n=(0,u.ZK)(t),r=(0,d.x7)(t);console.log("\uD83D\uDCCA Current inventory items:",n.length),console.log("\uD83C\uDF7DÔ∏è Available dishes:",r.length);let o=[];for(let t of e.items){let e=t.name,i=t.quantity;console.log(`üçΩÔ∏è Processing dish: ${e} (quantity: ${i})`);let a=r.find(t=>t.name.toLowerCase()===e.toLowerCase());if(!a){console.warn(`‚ö†Ô∏è Dish not found in menu: ${e}`);continue}let s=Array.isArray(a.ingredients)?a.ingredients.length:0;if(console.log(`üìã Dish found: ${a.name} with ${s} ingredients`),Array.isArray(a.ingredients))for(let e of a.ingredients){if(!(e&&"object"==typeof e&&"string"==typeof e.inventoryItemName&&"number"==typeof e.quantityPerDish&&"string"==typeof e.unit)){console.warn(`‚ö†Ô∏è Ingredient is not a structured object:`,e);continue}let t=e.inventoryItemName,r=e.quantityPerDish,a=e.unit,s=r*i;console.log(`ü•ò Ingredient: ${t} - ${r} ${a} per dish \xd7 ${i} dishes = ${s} ${a} total`);let u=n.find(e=>e.name.toLowerCase()===t.toLowerCase()||e.name.toLowerCase().includes(t.toLowerCase())||t.toLowerCase().includes(e.name.toLowerCase()));if(!u){console.warn(`‚ö†Ô∏è Inventory item not found: ${t}`);continue}console.log(`üì¶ Inventory item found: ${u.name} (current: ${u.quantity} ${u.unit})`);let d=s;if(a.toLowerCase()!==u.unit.toLowerCase()&&(d=function(e,t,n){let r=t.toLowerCase().trim(),o=n.toLowerCase().trim();if(r===o)return e;let i={g:{kg:.001,oz:.035274,lb:.00220462},kg:{g:1e3,oz:35.274,lb:2.20462},ml:{l:.001,oz:.033814,cup:.00422675},l:{ml:1e3,oz:33.814,cup:4.22675},oz:{g:28.3495,kg:.0283495,ml:29.5735,l:.0295735,cup:.125},cup:{ml:236.588,l:.236588,oz:8},pcs:{piece:1,unit:1},piece:{pcs:1,unit:1},unit:{pcs:1,piece:1}};return i[r]&&i[r][o]?e*i[r][o]:(console.warn(`No unit conversion found from ${t} to ${n}, using 1:1 ratio`),e)}(s,a,u.unit),console.log(`üîÑ Unit conversion: ${s} ${a} = ${d} ${u.unit}`)),u.quantity<d){console.warn(`‚ö†Ô∏è Insufficient stock for ${t}: available ${u.quantity} ${u.unit}, needed ${d} ${u.unit}`);continue}let c=u.quantity;u.quantity-=d,u.quantityUsed=(u.quantityUsed||0)+d,u.totalUsed=(u.totalUsed||0)+d,console.log(`‚úÖ Updated ${t}: ${c} ‚Üí ${u.quantity} ${u.unit} (used: +${d})`),o.push({item:t,oldQuantity:c,newQuantity:u.quantity,used:d,unit:u.unit})}}(0,u.zc)(t);let i=[];return console.log(`‚úÖ Inventory update completed: ${o.length} items updated`),console.log(`üö® New alerts generated: ${i.length}`),{success:!0,message:`Inventory updated successfully. ${o.length} items modified.`,updates:o,alerts:i}}catch(e){return console.error("‚ùå Error updating inventory:",e),{success:!1,message:"Error updating inventory",error:e instanceof Error?e.message:"Unknown error"}}}async function m(){return s.NextResponse.json({orders:c})}async function p(e){try{let t=await e.json();return c.push(t),s.NextResponse.json({order:t},{status:201})}catch(e){return s.NextResponse.json({error:"Invalid request"},{status:400})}}async function y(e){try{let{id:t,status:n,paymentMode:r,tipAmount:o,amountPaid:i,userId:a}=await e.json(),u=c.findIndex(e=>e.id===t);if(-1===u)return s.NextResponse.json({error:"Order not found"},{status:404});let d=c[u];return d.status=n,"Completed"===n&&(d.completedAt=new Date().toISOString(),await l(d,a)),r&&(d.paymentMode=r),void 0!==o&&(d.tipAmount=o),void 0!==i&&(d.amountPaid=i),s.NextResponse.json({order:c[u]})}catch(e){return s.NextResponse.json({error:"Invalid request"},{status:400})}}let g=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/orders/route",pathname:"/api/orders",filename:"route",bundlePath:"app/api/orders/route"},resolvedPagePath:"/Users/nishantchaturvedi/Desktop/IOMS/IOMS-V1-POS-Working/src/app/api/orders/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:f,workUnitAsyncStorage:h,serverHooks:q}=g;function w(){return(0,a.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:h})}},97904:(e,t,n)=>{"use strict";n.d(t,{ZK:()=>r,zc:()=>o});function r(e){return[]}function o(e){}}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[7719,580],()=>n(86841));module.exports=r})();